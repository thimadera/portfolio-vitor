(() => {
  const e = (e, t = document) => t.querySelector(e);
  e("#y").textContent = new Date().getFullYear();
  const t = e(".nav-toggle"),
    a = e("#menu");
  function i() {
    const e = window.matchMedia("(min-width: 901px)").matches;
    (a.hidden = !e), t.setAttribute("aria-expanded", "false");
  }
  i(),
    window.addEventListener("resize", i),
    t?.addEventListener("click", () => {
      const e = "true" === t.getAttribute("aria-expanded");
      t.setAttribute("aria-expanded", String(!e)), (a.hidden = e);
    }),
    a?.addEventListener("click", (e) => {
      e.target.closest("a") &&
        window.matchMedia("(max-width: 900px)").matches &&
        (t.setAttribute("aria-expanded", "false"), (a.hidden = !0));
    });
  const n = [
      { base: "look1", caption: "Corte e coloração" },
      {
        base: "look2",
        caption: "Luzes Loiro Vanilla com tratamento e finalização em ondas",
      },
      {
        base: "look3",
        caption:
          "Nutrição com base de óleo de mandioca e finalização em cachos",
      },
      { base: "look4", caption: "Corte masculino em camadas" },
    ],
    s = e("#gallery");
  s &&
    (s.innerHTML = n
      .map(function ({ base: e, caption: t }) {
        const a = "(max-width:600px) 50vw, 400px";
        return `<div class="card no-padding"><picture class="gallery__item" data-base="${e}" data-alt="${t}" tabindex="0" aria-label="Abrir ${t}">\n<source type="image/avif" srcset="assets/img/${e}.avif 800w, assets/img/${e}-400.avif 400w" sizes="${a}" />\n<source type="image/webp" srcset="assets/img/${e}.webp 800w, assets/img/${e}-400.webp 400w" sizes="${a}" />\n<img src="assets/img/${e}.jpg" alt="${t}" width="800" height="1000" loading="lazy" decoding="async" style="background:#f3f3f3" />\n<p class="gallery__caption">${t}</p>\n</picture></div>`;
      })
      .join(""));
  const o = e("#lightbox"),
    r = e("#lightbox-img"),
    c = e("#lightbox-caption"),
    d = e(".lightbox-close");
  let l = null;
  function m(e) {
    (r.src = `assets/img/${e.base}.jpg`),
      (r.alt = e.caption),
      (c.textContent = e.caption || ""),
      (l = document.activeElement),
      o.showModal(),
      d.focus();
  }
  s?.addEventListener("click", (e) => {
    const t = e.target.closest(".gallery__item");
    if (!t) return;
    const a = n.find((e) => e.base === t.dataset.base);
    a && m(a);
  }),
    s?.addEventListener("keydown", (e) => {
      if ("Enter" !== e.key && " " !== e.key) return;
      const t = e.target.closest(".gallery__item");
      if (!t) return;
      const a = n.find((e) => e.base === t.dataset.base);
      a && m(a), e.preventDefault();
    }),
    d?.addEventListener("click", () => o.close()),
    o?.addEventListener("click", (e) => {
      e.target === o && o.close();
    }),
    o?.addEventListener("keydown", (e) => {
      "Escape" === e.key && o.close();
    }),
    o?.addEventListener("keydown", (e) => {
      if ("Tab" !== e.key) return;
      const t = o.querySelectorAll(
          'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
        ),
        a = t[0],
        i = t[t.length - 1];
      e.shiftKey && document.activeElement === a
        ? (i.focus(), e.preventDefault())
        : e.shiftKey ||
          document.activeElement !== i ||
          (a.focus(), e.preventDefault());
    }),
    o?.addEventListener("close", () => {
      l && l.focus();
    });
  const u = e(".bottom-cta"),
    g = e(".wa-fab"),
    b = window.matchMedia("(max-width: 700px)");
  function p() {
    g && (g.style.display = b.matches ? "none" : "grid");
  }
  p(), b.addEventListener("change", p);
  const v = e(".hero"),
    h = window.matchMedia("(max-width: 900px)");
  "IntersectionObserver" in window && v && u
    ? (new IntersectionObserver(
        (e) => {
          return (
            (t = e[0].isIntersecting),
            void (h.matches && u
              ? t
                ? u.classList.remove("is-visible")
                : u.classList.add("is-visible")
              : u?.classList.remove("is-visible"))
          );
          var t;
        },
        { threshold: 0.2 }
      ).observe(v),
      h.addEventListener?.("change", () => u.classList.remove("is-visible")))
    : window.addEventListener("scroll", () => {
        h.matches &&
          u &&
          ((window.scrollY || document.documentElement.scrollTop) > 300
            ? u.classList.add("is-visible")
            : u.classList.remove("is-visible"));
      }),
    ((e, t = document) => Array.from(t.querySelectorAll(e)))(
      "a[data-wa]"
    ).forEach((e) => {
      const t =
          e.getAttribute("data-text") || "Oi Vitor! Quero agendar um horário.",
        a = e.getAttribute("data-medium") || "cta",
        i = e.getAttribute("data-campaign") || "agendamento";
      (e.href = (function (e, t, a) {
        return `https://wa.me/5515996831709?${new URLSearchParams({
          text: e,
          utm_source: "site",
          utm_medium: t,
          utm_campaign: a,
        }).toString()}`;
      })(t, a, i)),
        (e.target = "_blank"),
        (e.rel = "noopener noreferrer");
    });
})();
