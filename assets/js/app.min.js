(() => {
  const e = (e, t = document) => t.querySelector(e);
  e("#y").textContent = new Date().getFullYear();
  const t = e(".nav-toggle"),
    a = e("#menu");
  function i() {
    const e = window.matchMedia("(min-width: 901px)").matches;
    (a.hidden = !e), t.setAttribute("aria-expanded", "false");
  }
  i(),
    window.addEventListener("resize", i),
    t?.addEventListener("click", () => {
      const e = "true" === t.getAttribute("aria-expanded");
      t.setAttribute("aria-expanded", String(!e)), (a.hidden = e);
    }),
    a?.addEventListener("click", (e) => {
      e.target.closest("a") &&
        window.matchMedia("(max-width: 900px)").matches &&
        (t.setAttribute("aria-expanded", "false"), (a.hidden = !0));
    });
  const s = [
      {
        base: "look1",
        alt: "Corte bob texturizado",
        caption: "Corte bob com texturização leve",
      },
      {
        base: "look2",
        alt: "Luzes em morena iluminada",
        caption: "Luzes sutis para iluminar sem danificar",
      },
      {
        base: "look3",
        alt: "Cacheados com finalização definida",
        caption: "Definição e brilho para cachos",
      },
      {
        base: "look4",
        alt: "Corte curto masculino degradê",
        caption: "Degradê preciso com acabamento limpo",
      },
    ],
    n = e("#gallery");
  n &&
    (n.innerHTML = s
      .map(function ({ base: e, alt: t }) {
        const a = "(max-width:600px) 50vw, 400px";
        return `\n            <picture class="gallery__item" data-base="${e}" data-alt="${t}" tabindex="0" aria-label="Abrir ${t}">\n              <source type="image/avif" srcset="assets/img/${e}.avif 800w, assets/img/${e}-400.avif 400w" sizes="${a}" />\n              <source type="image/webp" srcset="assets/img/${e}.webp 800w, assets/img/${e}-400.webp 400w" sizes="${a}" />\n              <img src="assets/img/${e}.jpg" alt="${t}" width="800" height="1000" loading="lazy" decoding="async" style="background:#f3f3f3" />\n            </picture>`;
      })
      .join(""));
  const o = e("#lightbox"),
    r = e("#lightbox-img"),
    c = e("#lightbox-caption"),
    d = e(".lightbox-close");
  let l = null;
  function m(e) {
    (r.src = `assets/img/${e.base}.jpg`),
      (r.alt = e.alt),
      (c.textContent = e.caption || ""),
      (l = document.activeElement),
      o.showModal(),
      d.focus();
  }
  n?.addEventListener("click", (e) => {
    const t = e.target.closest(".gallery__item");
    if (!t) return;
    const a = s.find((e) => e.base === t.dataset.base);
    a && m(a);
  }),
    n?.addEventListener("keydown", (e) => {
      if ("Enter" !== e.key && " " !== e.key) return;
      const t = e.target.closest(".gallery__item");
      if (!t) return;
      const a = s.find((e) => e.base === t.dataset.base);
      a && m(a), e.preventDefault();
    }),
    d?.addEventListener("click", () => o.close()),
    o?.addEventListener("click", (e) => {
      e.target === o && o.close();
    }),
    o?.addEventListener("keydown", (e) => {
      "Escape" === e.key && o.close();
    }),
    o?.addEventListener("keydown", (e) => {
      if ("Tab" !== e.key) return;
      const t = o.querySelectorAll(
          'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
        ),
        a = t[0],
        i = t[t.length - 1];
      e.shiftKey && document.activeElement === a
        ? (i.focus(), e.preventDefault())
        : e.shiftKey ||
          document.activeElement !== i ||
          (a.focus(), e.preventDefault());
    }),
    o?.addEventListener("close", () => {
      l && l.focus();
    });
  const u = e(".bottom-cta"),
    b = e(".wa-fab"),
    g = window.matchMedia("(max-width: 700px)");
  function h() {
    b && (b.style.display = g.matches ? "none" : "grid");
  }
  h(), g.addEventListener("change", h);
  const p = e(".hero"),
    f = window.matchMedia("(max-width: 900px)");
  if ("IntersectionObserver" in window && p && u) {
    new IntersectionObserver(
      (e) => {
        return (
          (t = e[0].isIntersecting),
          void (f.matches && u
            ? t
              ? u.classList.remove("is-visible")
              : u.classList.add("is-visible")
            : u?.classList.remove("is-visible"))
        );
        var t;
      },
      { threshold: 0.2 }
    ).observe(p),
      f.addEventListener?.("change", () => u.classList.remove("is-visible"));
  } else
    window.addEventListener("scroll", () => {
      if (!f.matches || !u) return;
      (window.scrollY || document.documentElement.scrollTop) > 300
        ? u.classList.add("is-visible")
        : u.classList.remove("is-visible");
    });
  ((e, t = document) => Array.from(t.querySelectorAll(e)))(
    "a[data-wa]"
  ).forEach((e) => {
    const t = e.getAttribute("data-text") || "Oi Vitor! Quero agendar um horário.",
      a = e.getAttribute("data-medium") || "cta",
      i = e.getAttribute("data-campaign") || "agendamento";
    (e.href = (function (e, t, a) {
      return `https://wa.me/5515996831709?${new URLSearchParams({
        text: e,
        utm_source: "site",
        utm_medium: t,
        utm_campaign: a,
      }).toString()}`;
    })(t, a, i)),
      (e.target = "_blank"),
      (e.rel = "noopener noreferrer");
  });
})();
